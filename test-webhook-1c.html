<!DOCTYPE html>
<html>
<head>
    <title>Test 1C Webhook</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; }
        textarea { width: 100%; height: 200px; }
        button { padding: 10px 20px; margin: 5px; background: #007cba; color: white; border: none; cursor: pointer; }
        .result { margin-top: 20px; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; }
        .error { background: #ffe6e6; border-color: #ff9999; }
        .success { background: #e6ffe6; border-color: #99ff99; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test 1C Webhook</h1>
        
        <h3>Test Update (—Å—Ç–≤–æ—Ä—é—î –Ω–∞–∫–ª–∞–¥–Ω—É —è–∫—â–æ –Ω–µ —ñ—Å–Ω—É—î)</h3>
        <textarea id="updateData">{
  "action": "update",
  "invoiceData": {
    "–ù–æ–º–µ—Ä–î–æ–∫—É–º–µ–Ω—Ç–∞": "–†–ú00-000562",
    "–î–∞—Ç–∞–î–æ–∫—É–º–µ–Ω—Ç–∞": "2025-06-18T17:00:09",
    "–ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫": "–ê–õ–¨–§–ê-–ü–õ–ê–°–¢",
    "–Ñ–î–†–ü–û–£": "38138158",
    "–°—É–º–º–∞–î–æ–∫—É–º–µ–Ω—Ç–∞": 7200,
    "–ö–æ–¥–í–∞–ª—é—Ç—ã": "980",
    "positions": [
      {
        "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–¢–æ–≤–∞—Ä–∞": "–§–µ–Ω–æ–ª—å–Ω—ñ —Ñ–æ—Ä–º–æ–≤–æ—á–Ω—ñ –∫–æ–º–ø–∞—É–Ω–¥–∏",
        "–ö–æ–¥–¢–æ–≤–∞—Ä–∞": "00000026579",
        "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ": 50,
        "–¶–µ–Ω–∞": 120,
        "–°—É–º–º–∞": 6000
      }
    ]
  }
}</textarea>
        <button onclick="testWebhook('updateData')">Test Update</button>
        
        <h3>Test Create</h3>
        <textarea id="createData">{
  "action": "create",
  "invoiceData": {
    "–ù–æ–º–µ—Ä–î–æ–∫—É–º–µ–Ω—Ç–∞": "–†–ú00-000999",
    "–î–∞—Ç–∞–î–æ–∫—É–º–µ–Ω—Ç–∞": "2025-07-20T18:30:00",
    "–ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫": "–¢–ï–°–¢ –ü–û–°–¢–ê–ß–ê–õ–¨–ù–ò–ö",
    "–Ñ–î–†–ü–û–£": "12345678",
    "–°—É–º–º–∞–î–æ–∫—É–º–µ–Ω—Ç–∞": 5000,
    "–ö–æ–¥–í–∞–ª—é—Ç—ã": "980",
    "positions": [
      {
        "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–¢–æ–≤–∞—Ä–∞": "–¢–µ—Å—Ç–æ–≤–∏–π —Ç–æ–≤–∞—Ä",
        "–ö–æ–¥–¢–æ–≤–∞—Ä–∞": "TEST001",
        "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ": 10,
        "–¶–µ–Ω–∞": 500,
        "–°—É–º–º–∞": 5000
      }
    ]
  }
}</textarea>
        <button onclick="testWebhook('createData')">Test Create</button>
        
        <div id="result" class="result" style="display: none;"></div>
    </div>

    <script>
        async function testWebhook(textareaId) {
            const data = JSON.parse(document.getElementById(textareaId).value);
            const resultDiv = document.getElementById('result');
            
            try {
                const response = await fetch('/api/webhook/test-invoice', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                resultDiv.style.display = 'block';
                resultDiv.className = response.ok ? 'result success' : 'result error';
                resultDiv.innerHTML = `
                    <h4>${response.ok ? '‚úÖ –£—Å–ø—ñ—Ö' : '‚ùå –ü–æ–º–∏–ª–∫–∞'}</h4>
                    <pre>${JSON.stringify(result, null, 2)}</pre>
                `;
            } catch (error) {
                resultDiv.style.display = 'block';
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `
                    <h4>‚ùå –ü–æ–º–∏–ª–∫–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è</h4>
                    <pre>${error.message}</pre>
                `;
            }
        }
    </script>
</body>
</html>