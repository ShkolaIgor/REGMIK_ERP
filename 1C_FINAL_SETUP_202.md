# üéØ –§—ñ–Ω–∞–ª—å–Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è 1–° –¥–ª—è –Ω–∞–∫–ª–∞–¥–Ω–∏—Ö –∑ —Ä–∞—Ö—É–Ω–∫–æ–º 202

## ‚úÖ –ì–æ—Ç–æ–≤–æ –≤ ERP —Å–∏—Å—Ç–µ–º—ñ:
- API endpoint `/api/1c/invoices-202` –ø—Ä–∞—Ü—é—î
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Import1CInvoices202 –∑ —Ñ—ñ–æ–ª–µ—Ç–æ–≤–∏–º –∫–æ–ª—å–æ—Ä–æ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑—ñ—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ –≤ ERP
- Fallback –¥–∞–Ω—ñ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è 1–° (–≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è):

### 1. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ endpoint `/invoices` –∑ POST –º–µ—Ç–æ–¥–æ–º
```http
POST /hs/erp/invoices
Content-Type: application/json

{
  "action": "getInvoices202",
  "limit": 100
}
```

### 2. –ö–æ–¥ –¥–ª—è 1–° –∑ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º –ø–æ–º–∏–ª–∫–∏ "–ù–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–µ –ø–æ–ª–µ":

```1c
// –í–ò–ü–†–ê–í–õ–ï–ù–ò–ô –æ–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è endpoint /invoices
–ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –û–±—Ä–∞–±–æ—Ç–∞—Ç—å–ó–∞–ø—Ä–æ—Å–ù–∞–∫–ª–∞–¥–Ω—ã—Ö(–ó–∞–ø—Ä–æ—Å, –û—Ç–≤–µ—Ç) –≠–∫—Å–ø–æ—Ä—Ç
    
    –ü–æ–ø—ã—Ç–∫–∞
        
        // –û—Ç—Ä–∏–º—É—î–º–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–∞–ø–∏—Ç—É
        –¢–µ–ª–æ–ó–∞–ø—Ä–æ—Å–∞ = –ó–∞–ø—Ä–æ—Å.–ü–æ–ª—É—á–∏—Ç—å–¢–µ–ª–æ–ö–∞–∫–°—Ç—Ä–æ–∫—É();
        
        // –ü–∞—Ä—Å–∏–Ω–≥ JSON –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
        –ß—Ç–µ–Ω–∏–µJSON = –ù–æ–≤—ã–π –ß—Ç–µ–Ω–∏–µJSON;
        –ß—Ç–µ–Ω–∏–µJSON.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–°—Ç—Ä–æ–∫—É(–¢–µ–ª–æ–ó–∞–ø—Ä–æ—Å–∞);
        –ü–∞—Ä–∞–º–µ—Ç—Ä—ã–ó–∞–ø—Ä–æ—Å–∞ = –ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON(–ß—Ç–µ–Ω–∏–µJSON);
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Ç–∏–ø –∑–∞–ø–∏—Ç—É
        –ï—Å–ª–∏ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã–ó–∞–ø—Ä–æ—Å–∞.action = "getInvoices202" –¢–æ–≥–¥–∞
            // –û—Ç—Ä–∏–º—É—î–º–æ –Ω–∞–∫–ª–∞–¥–Ω—ñ –∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é –ø–æ —Ä–∞—Ö—É–Ω–∫—É 202
            –ú–∞—Å—Å–∏–≤–ù–∞–∫–ª–∞–¥–Ω—ã—Ö = –ü–æ–ª—É—á–∏—Ç—å–ù–∞–∫–ª–∞–¥–Ω—ã–µ–°–§—ñ–ª—å—Ç—Ä–æ–º–ü–æ202();
        –ò–Ω–∞—á–µ
            // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –∑–∞–ø–∏—Ç –≤—Å—ñ—Ö –Ω–∞–∫–ª–∞–¥–Ω–∏—Ö
            –ú–∞—Å—Å–∏–≤–ù–∞–∫–ª–∞–¥–Ω—ã—Ö = –ü–æ–ª—É—á–∏—Ç—å–í—Å–µ–ù–∞–∫–ª–∞–¥–Ω—ã–µ();
        –ö–æ–Ω–µ—Ü–ï—Å–ª–∏;
        
        // –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ –≤ JSON
        –ó–∞–ø–∏—Å—åJSON = –ù–æ–≤—ã–π –ó–∞–ø–∏—Å—åJSON;
        –°—Ç—Ä–æ–∫–∞JSON = "";
        –ó–∞–ø–∏—Å—åJSON.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–°—Ç—Ä–æ–∫—É(–°—Ç—Ä–æ–∫–∞JSON);
        –ó–∞–ø–∏—Å–∞—Ç—åJSON(–ó–∞–ø–∏—Å—åJSON, –ú–∞—Å—Å–∏–≤–ù–∞–∫–ª–∞–¥–Ω—ã—Ö);
        
        // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
        –û—Ç–≤–µ—Ç.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–¢–µ–ª–æ–ò–∑–°—Ç—Ä–æ–∫–∏(–°—Ç—Ä–æ–∫–∞JSON);
        –û—Ç–≤–µ—Ç.–ó–∞–≥–æ–ª–æ–≤–∫–∏.–í—Å—Ç–∞–≤–∏—Ç—å("Content-Type", "application/json; charset=utf-8");
        –û—Ç–≤–µ—Ç.–ö–æ–¥–°–æ—Å—Ç–æ—è–Ω–∏—è = 200;
        
    –ò—Å–∫–ª—é—á–µ–Ω–∏–µ
        
        –¢–µ–∫—Å—Ç–û—à–∏–±–∫–∏ = –û–ø–∏—Å–∞–Ω–∏–µ–û—à–∏–±–∫–∏();
        –û—Ç–≤–µ—Ç.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–¢–µ–ª–æ–ò–∑–°—Ç—Ä–æ–∫–∏("{""error"":""" + –¢–µ–∫—Å—Ç–û—à–∏–±–∫–∏ + """}");
        –û—Ç–≤–µ—Ç.–ó–∞–≥–æ–ª–æ–≤–∫–∏.–í—Å—Ç–∞–≤–∏—Ç—å("Content-Type", "application/json; charset=utf-8");
        –û—Ç–≤–µ—Ç.–ö–æ–¥–°–æ—Å—Ç–æ—è–Ω–∏—è = 500;
        
    –ö–æ–Ω–µ—Ü–ü–æ–ø—ã—Ç–∫–∏;
    
–ö–æ–Ω–µ—Ü–ü—Ä–æ—Ü–µ–¥—É—Ä—ã
```

### 3. –§—É–Ω–∫—Ü—ñ—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó (–∑ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∏–º–∏ –∞–ª—ñ–∞—Å–∞–º–∏):

```1c
–§—É–Ω–∫—Ü–∏—è –ü–æ–ª—É—á–∏—Ç—å–ù–∞–∫–ª–∞–¥–Ω—ã–µ–°–§—ñ–ª—å—Ç—Ä–æ–º–ü–æ202() –≠–∫—Å–ø–æ—Ä—Ç
    
    –ú–∞—Å—Å–∏–≤–ù–∞–∫–ª–∞–¥–Ω—ã—Ö = –ù–æ–≤—ã–π –ú–∞—Å—Å–∏–≤;
    
    –î–∞—Ç–∞–ù–∞—á–∞–ª–∞ = –ù–∞—á–∞–ª–æ–ú–µ—Å—è—Ü–∞(–¢–µ–∫—É—â–∞—è–î–∞—Ç–∞() - 86400 * 90);
    –î–∞—Ç–∞–û–∫–æ–Ω—á–∞–Ω–∏—è = –ö–æ–Ω–µ—Ü–î–Ω—è(–¢–µ–∫—É—â–∞—è–î–∞—Ç–∞());
    
    –ó–∞–ø—Ä–æ—Å = –ù–æ–≤—ã–π –ó–∞–ø—Ä–æ—Å;
    –ó–∞–ø—Ä–æ—Å.–¢–µ–∫—Å—Ç = "
        |–í–´–ë–†–ê–¢–¨ –†–ê–ó–õ–ò–ß–ù–´–ï
        |    –ü–¢–£.–°—Å—ã–ª–∫–∞ –ö–ê–ö –°—Å—ã–ª–∫–∞–î–æ–∫—É–º–µ–Ω—Ç–∞,
        |    –ü–¢–£.–ù–æ–º–µ—Ä –ö–ê–ö –ù–æ–º–µ—Ä–î–æ–∫—É–º–µ–Ω—Ç–∞,
        |    –ü–¢–£.–î–∞—Ç–∞ –ö–ê–ö –î–∞—Ç–∞–î–æ–∫—É–º–µ–Ω—Ç–∞,
        |    –ü–¢–£.–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ö–ê–ö –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞,
        |    –ü–¢–£.–°—É–º–º–∞–î–æ–∫—É–º–µ–Ω—Ç–∞ –ö–ê–ö –°—É–º–º–∞–î–æ–∫—É–º–µ–Ω—Ç–∞,
        |    –ü–¢–£.–í–∞–ª—é—Ç–∞–î–æ–∫—É–º–µ–Ω—Ç–∞.–ö–æ–¥ –ö–ê–ö –ö–æ–¥–í–∞–ª—é—Ç—ã,
        |    –ü–¢–£.–ü—Ä–æ–≤–µ–¥–µ–Ω –ö–ê–ö –ü—Ä–æ–≤–µ–¥–µ–Ω
        |–ò–ó
        |    –î–æ–∫—É–º–µ–Ω—Ç.–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ–¢–æ–≤–∞—Ä–æ–≤–£—Å–ª—É–≥ –ö–ê–ö –ü–¢–£
        |        –í–ù–£–¢–†–ï–ù–ù–ï–ï –°–û–ï–î–ò–ù–ï–ù–ò–ï –î–æ–∫—É–º–µ–Ω—Ç.–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ–¢–æ–≤–∞—Ä–æ–≤–£—Å–ª—É–≥.–¢–æ–≤–∞—Ä—ã –ö–ê–ö –¢–æ–≤–∞—Ä—ã202
        |        –ü–û –ü–¢–£.–°—Å—ã–ª–∫–∞ = –¢–æ–≤–∞—Ä—ã202.–°—Å—ã–ª–∫–∞
        |        –ò –¢–æ–≤–∞—Ä—ã202.–°—á–µ—Ç–£—á–µ—Ç–∞–ë–£.–ö–æ–¥ = ""202""
        |–ì–î–ï
        |    –ü–¢–£.–î–∞—Ç–∞ –ú–ï–ñ–î–£ &–î–∞—Ç–∞–ù–∞—á–∞–ª–∞ –ò &–î–∞—Ç–∞–û–∫–æ–Ω—á–∞–Ω–∏—è
        |    –ò –ü–¢–£.–ü–æ–º–µ—Ç–∫–∞–£–¥–∞–ª–µ–Ω–∏—è = –õ–û–ñ–¨
        |    –ò –ü–¢–£.–ü—Ä–æ–≤–µ–¥–µ–Ω = –ò–°–¢–ò–ù–ê
        |–£–ü–û–†–Ø–î–û–ß–ò–¢–¨ –ü–û
        |    –ü–¢–£.–î–∞—Ç–∞ –£–ë–´–í";
    
    –ó–∞–ø—Ä–æ—Å.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–ü–∞—Ä–∞–º–µ—Ç—Ä("–î–∞—Ç–∞–ù–∞—á–∞–ª–∞", –î–∞—Ç–∞–ù–∞—á–∞–ª–∞);
    –ó–∞–ø—Ä–æ—Å.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–ü–∞—Ä–∞–º–µ—Ç—Ä("–î–∞—Ç–∞–û–∫–æ–Ω—á–∞–Ω–∏—è", –î–∞—Ç–∞–û–∫–æ–Ω—á–∞–Ω–∏—è);
    
    // ... —Ä–µ—à—Ç–∞ –ª–æ–≥—ñ–∫–∏ –æ–±—Ä–æ–±–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
    
    –í–æ–∑–≤—Ä–∞—Ç –ú–∞—Å—Å–∏–≤–ù–∞–∫–ª–∞–¥–Ω—ã—Ö;
    
–ö–æ–Ω–µ—Ü–§—É–Ω–∫—Ü–∏–∏
```

## üîç –ö–ª—é—á–æ–≤—ñ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:

1. **–î–æ–∫—É–º–µ–Ω—Ç.–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ–¢–æ–≤–∞—Ä–æ–≤–£—Å–ª—É–≥** (–±–µ–∑ "–ò")
2. **–£–Ω—ñ–∫–∞–ª—å–Ω—ñ –∞–ª—ñ–∞—Å–∏**: –ü–¢–£, –¢–æ–≤–∞—Ä—ã202, –¢202
3. **–û–¥–∏–Ω endpoint** `/invoices` –¥–ª—è –≤—Å—ñ—Ö —Ç–∏–ø—ñ–≤ –Ω–∞–∫–ª–∞–¥–Ω–∏—Ö
4. **–ü–∞—Ä–∞–º–µ—Ç—Ä action** –¥–ª—è —Ä–æ–∑—Ä—ñ–∑–Ω–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤ –∑–∞–ø–∏—Ç—ñ–≤

## üìã –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:

ERP —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ —ñ –ø—Ä–∞—Ü—é—î –∑ fallback –¥–∞–Ω–∏–º–∏. –ü—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è 1–°:
- –ù–∞–∫–ª–∞–¥–Ω—ñ –∑ —Ä–∞—Ö—É–Ω–∫–æ–º 202 –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ñ—ñ–ª—å—Ç—Ä—É—é—Ç—å—Å—è
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –∑—ñ—Å—Ç–∞–≤–ª—è—é—Ç—å—Å—è –∑ ERP –±–∞–∑–æ—é
- –§—ñ–æ–ª–µ—Ç–æ–≤–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—ñ–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑—Ä—ñ–∑–Ω–µ–Ω–Ω—è

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:
‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ production –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑ —Ä–µ–∞–ª—å–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ –∑ 1–°!