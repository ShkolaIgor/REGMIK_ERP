# Виправлений код 1C для BAF системи

## Проблема: "Обробник запиту не знайдено" (HTTP 500)

Це означає, що функція `invoicesPOST` має синтаксичну помилку або не існує. 

## КРОК 1: Мінімальний робочий код

Замініть весь код HTTP-сервісу на цей простий варіант:

```1c
Функция invoicesPOST(Запрос)
    
    Попытка
        // Записуємо в журнал спробу виклику
        ЗаписьЖурналаРегистрации("ERP.Test", УровеньЖурналаРегистрации.Информация,,,
            "Получен запрос от ERP системы");
        
        // Простий тестовий JSON
        СтрокаJSON = "[{""ID"":""TEST-001"",""НомерДокумента"":""ПТУ-TEST"",""Дата"":""2025-07-10"",""Постачальник"":""Тестовый контрагент"",""Сума"":10000,""Валюта"":""UAH"",""Статус"":""new""}]";
        
        // Створюємо відповідь
        Ответ = Новый HTTPСоответствие();
        Ответ.УстановитьТелоИзСтроки(СтрокаJSON, КодировкаТекста.UTF8);
        Ответ.Заголовки.Вставить("Content-Type", "application/json; charset=utf-8");
        Ответ.КодСостояния = 200;
        
        ЗаписьЖурналаРегистрации("ERP.Test", УровеньЖурналаРегистрации.Информация,,,
            "Отправлен JSON: " + СтрокаJSON);
        
        Возврат Ответ;
        
    Исключение
        // Логуємо помилку
        ЗаписьЖурналаРегистрации("ERP.Error", УровеньЖурналаРегистрации.Ошибка,,,
            "Ошибка в invoicesPOST: " + ОписаниеОшибки());
        
        // Повертаємо помилку
        ОтветОшибка = Новый HTTPСоответствие();
        ОтветОшибка.УстановитьТелоИзСтроки("Error: " + ОписаниеОшибки(), КодировкаТекста.UTF8);
        ОтветОшибка.КодСостояния = 500;
        Возврат ОтветОшибка;
        
    КонецПопытки;
    
КонецФункции
```

## КРОК 2: Перевірка журналу

Після встановлення цього коду:

1. **Викличте ERP endpoint** для отримання накладних
2. **Перевірте журнал реєстрації 1C** на наявність записів:
   - "Получен запрос от ERP системы"
   - "Отправлен JSON: ..."
   - Або помилки в "ERP.Error"

## КРОК 3: Очікувані результати

Якщо код правильно встановлено, ERP отримає:
```json
[
  {
    "ID": "TEST-001",
    "НомерДокумента": "ПТУ-TEST", 
    "Дата": "2025-07-10",
    "Постачальник": "Тестовый контрагент",
    "Сума": 10000,
    "Валюта": "UAH",
    "Статус": "new"
  }
]
```

## Наступні кроки:

Після успішного тестування цього простого коду, перейдемо до:
- Діагностики структури бази 1C
- Налаштування реальних запитів до документів
- Повної інтеграції з позиціями накладних

## Можливі проблеми:

1. **Синтаксичні помилки** - перевірте всі крапки з комами
2. **Неправильне ім'я функції** - має бути точно `invoicesPOST`
3. **Права доступу** - функція має бути доступна для HTTP-сервісу
4. **Кодування** - використовуйте UTF-8

Встановіть цей код та повідомте результат.