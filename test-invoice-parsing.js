// –î–µ—Ç–∞–ª—å–Ω–∏–π —Ç–µ—Å—Ç –ø–∞—Ä—Å–∏–Ω–≥—É –±–∞–Ω–∫—ñ–≤—Å—å–∫–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è —Å—Ç–∞—Ä–æ–≥–æ —Ç–∞ –Ω–æ–≤–æ–≥–æ —Ä–∞—Ö—É–Ω–∫—ñ–≤

const testInvoiceParsing = async () => {
  try {
    console.log('üß™ === –î–ï–¢–ê–õ–¨–ù–ò–ô –¢–ï–°–¢ –ü–ê–†–°–ò–ù–ì–£ –ë–ê–ù–ö–Ü–í–°–¨–ö–ò–• –ü–û–í–Ü–î–û–ú–õ–ï–ù–¨ ===\n');
    
    // –¢–µ—Å—Ç 1: –°—Ç–∞—Ä–∏–π —Ä–∞—Ö—É–Ω–æ–∫ –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º —Ñ–æ—Ä–º–∞—Ç–æ–º
    console.log('üìã –¢–ï–°–¢ 1: –°—Ç–∞—Ä–∏–π —Ä–∞—Ö—É–Ω–æ–∫ (2013) –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º —Ñ–æ—Ä–º–∞—Ç–æ–º...');
    const oldInvoiceEmailContent = `
Subject: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –æ–ø–µ—Ä–∞—Ü—ñ—é –ø–æ –∫–∞—Ä—Ç–∫–æ–≤–æ–º—É —Ä–∞—Ö—É–Ω–∫—É
Date: Mon, 21 Jul 2025 13:32:17 +0300 (EEST)

<br>–ë–∞–Ω–∫ –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫: –£–ö–†–°–Ü–ë–ë–ê–ù–ö<br>
<br>  09:15 <br> —Ä—É—Ö –∫–æ—à—Ç—ñ–≤ –ø–æ –∫–∞—Ä—Ç-—Ä–∞—Ö—É–Ω–∫—É<br>
<br>–∑–≥. —Ä–∞—Ö. ‚Ññ 999999 –≤—ñ–¥ 15.01.2013—Ä.<br>
<br>—Å—É–º–º–∞: 12345.67<br>
<br>—Ç–∏–ø –æ–ø–µ—Ä–∞—Ü—ñ—ó: –∑–∞—Ä–∞—Ö–æ–≤–∞–Ω–æ<br>
<br>–∫–æ—Ä—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç: –¢–µ—Å—Ç–æ–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—è –¥–ª—è —Å—Ç–∞—Ä–æ–≥–æ —Ä–∞—Ö—É–Ω–∫—É –¢–û–í<br>
<br>–ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–ª–∞—Ç–µ–∂—É: –û–ø–ª–∞—Ç–∞ –∑–∞ —Ç–æ–≤–∞—Ä–∏ –∑–≥. —Ä–∞—Ö. ‚Ññ999999 –≤—ñ–¥ 15.01.2013—Ä., —É —Ç.—á. –ü–î–í 20% - 2057.61 –≥—Ä–Ω.<br>
    `;
    
    const response1 = await fetch('http://localhost:5000/api/test-universal-invoice-parsing', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        inputText: oldInvoiceEmailContent
      })
    });
    
    const result1 = await response1.json();
    console.log('   –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç–∞—Ä–æ–≥–æ —Ä–∞—Ö—É–Ω–∫—É:', result1.foundInvoice ? '‚úÖ –£–°–ü–Ü–®–ù–û' : '‚ùå –ù–ï –ó–ù–ê–ô–î–ï–ù–û');
    if (result1.foundInvoice) {
      console.log(`   –ù–æ–º–µ—Ä: ${result1.foundInvoice}`);
      console.log(`   –ü—Ä–∏—á–∏–Ω–∞: ${result1.reason || '–Ω–µ –≤–∫–∞–∑–∞–Ω–æ'}`);
    }
    
    // –¢–µ—Å—Ç 2: –ù–æ–≤–∏–π —Ä–∞—Ö—É–Ω–æ–∫ –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º —Ñ–æ—Ä–º–∞—Ç–æ–º
    console.log('\nüìã –¢–ï–°–¢ 2: –ù–æ–≤–∏–π —Ä–∞—Ö—É–Ω–æ–∫ (2025) –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º —Ñ–æ—Ä–º–∞—Ç–æ–º...');
    const newInvoiceEmailContent = `
Subject: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –æ–ø–µ—Ä–∞—Ü—ñ—é –ø–æ –∫–∞—Ä—Ç–∫–æ–≤–æ–º—É —Ä–∞—Ö—É–Ω–∫—É
Date: Mon, 21 Jul 2025 13:32:17 +0300 (EEST)

<br>–ë–∞–Ω–∫ –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫: –£–ö–†–°–Ü–ë–ë–ê–ù–ö<br>
<br>  14:25 <br> —Ä—É—Ö –∫–æ—à—Ç—ñ–≤ –ø–æ –∫–∞—Ä—Ç-—Ä–∞—Ö—É–Ω–∫—É<br>
<br>–∑–≥. —Ä–∞—Ö. ‚Ññ 27435 –≤—ñ–¥ 11.06.2025—Ä.<br>
<br>—Å—É–º–º–∞: 39535.20<br>
<br>—Ç–∏–ø –æ–ø–µ—Ä–∞—Ü—ñ—ó: –∑–∞—Ä–∞—Ö–æ–≤–∞–Ω–æ<br>
<br>–∫–æ—Ä—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç: –¢–æ–≤–∞—Ä–∏—Å—Ç–≤–æ –∑ –æ–±–º–µ–∂–µ–Ω–æ—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—é "–ê–ì–†–û-–û–í–ï–ù"<br>
<br>–ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–ª–∞—Ç–µ–∂—É: –û–ø–ª–∞—Ç–∞ –∑–∞ —Ç–µ—Ä–º–æ–ø–µ—Ä–µ—Ç–≤–æ—Ä—é–≤–∞—á, –¥–∞—Ç—á–∏–∫ –≤–æ–ª–æ–≥–æ—Å—Ç—ñ —Ç–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏ –∑–≥. —Ä–∞—Ö. 27435 –≤—ñ–¥ 11.06.2025—Ä., —É —Ç.—á. –ü–î–í 20% - 6589.20 –≥—Ä–Ω.<br>
    `;
    
    const response2 = await fetch('http://localhost:5000/api/test-universal-invoice-parsing', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        inputText: newInvoiceEmailContent
      })
    });
    
    const result2 = await response2.json();
    console.log('   –ü–∞—Ä—Å–∏–Ω–≥ –Ω–æ–≤–æ–≥–æ —Ä–∞—Ö—É–Ω–∫—É:', result2.foundInvoice ? '‚úÖ –£–°–ü–Ü–®–ù–û' : '‚ùå –ù–ï –ó–ù–ê–ô–î–ï–ù–û');
    if (result2.foundInvoice) {
      console.log(`   –ù–æ–º–µ—Ä: ${result2.foundInvoice}`);
      console.log(`   –ü—Ä–∏—á–∏–Ω–∞: ${result2.reason || '–Ω–µ –≤–∫–∞–∑–∞–Ω–æ'}`);
    }
    
    // –¢–µ—Å—Ç 3: –ü—Ä—è–º–∏–π —Ç–µ—Å—Ç –±–∞–Ω–∫—ñ–≤—Å—å–∫–æ–≥–æ email –∞–Ω–∞–ª—ñ–∑—É
    console.log('\nüìã –¢–ï–°–¢ 3: –ü—Ä—è–º–∏–π —Ç–µ—Å—Ç –±–∞–Ω–∫—ñ–≤—Å—å–∫–æ–≥–æ email –∞–Ω–∞–ª—ñ–∑—É...');
    const response3 = await fetch('http://localhost:5000/api/test-bank-email-analysis', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        emailContent: oldInvoiceEmailContent,
        emailFrom: 'online@ukrsibbank.com'
      })
    });
    
    const result3 = await response3.json();
    console.log('   –ê–Ω–∞–ª—ñ–∑ —Å—Ç–∞—Ä–æ–≥–æ email:', result3.success ? '‚úÖ –£–°–ü–Ü–®–ù–û' : '‚ùå –ù–ï –í–î–ê–õ–û–°–Ø');
    if (result3.paymentInfo) {
      console.log(`   –ù–æ–º–µ—Ä —Ä–∞—Ö—É–Ω–∫—É: ${result3.paymentInfo.invoiceNumber}`);
      console.log(`   –î–∞—Ç–∞ —Ä–∞—Ö—É–Ω–∫—É: ${result3.paymentInfo.invoiceDate}`);
      console.log(`   –°—É–º–∞: ${result3.paymentInfo.amount}`);
      console.log(`   –ö–æ—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç: ${result3.paymentInfo.correspondent}`);
    }
    
    console.log('\nüéØ === –í–ò–°–ù–û–í–ö–ò ===');
    console.log('   üìå –ü–∞—Ä—Å–∏–Ω–≥ –±–∞–Ω–∫—ñ–≤—Å—å–∫–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å:');
    console.log(`   üìå –°—Ç–∞—Ä–∏–π —Ä–∞—Ö—É–Ω–æ–∫ (2013): ${result1.foundInvoice ? '–∑–Ω–∞–π–¥–µ–Ω–æ' : '–Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ'}`);
    console.log(`   üìå –ù–æ–≤–∏–π —Ä–∞—Ö—É–Ω–æ–∫ (2025): ${result2.foundInvoice ? '–∑–Ω–∞–π–¥–µ–Ω–æ' : '–Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ'}`);
    console.log(`   üìå Email –∞–Ω–∞–ª—ñ–∑: ${result3.success ? '–ø—Ä–∞—Ü—é—î' : '–Ω–µ –ø—Ä–∞—Ü—é—î'}`);
    
    if (result1.foundInvoice && result2.foundInvoice && result3.success) {
      console.log('\nüéØ === –ù–ê–°–¢–£–ü–ù–ò–ô –ö–†–û–ö ===');
      console.log('   ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–∞—Ü—é—î –ø—Ä–∞–≤–∏–ª—å–Ω–æ');
      console.log('   ‚û°Ô∏è  –ü–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ 6-–º—ñ—Å—è—á–Ω–∏–π —Ñ—ñ–ª—å—Ç—Ä —É –±–∞–Ω–∫—ñ–≤—Å—å–∫–æ–º—É –ø—Ä–æ—Ü–µ—Å–∏–Ω–≥—É');
      console.log('   ‚û°Ô∏è  –°—Ç–∞—Ä–∏–π —Ä–∞—Ö—É–Ω–æ–∫ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –≤—ñ–¥—Ö–∏–ª–µ–Ω–æ —á–µ—Ä–µ–∑ –¥–∞—Ç—É');
    }
    
  } catch (error) {
    console.error('‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É –ø–∞—Ä—Å–∏–Ω–≥—É:', error.message);
  }
};

testInvoiceParsing();